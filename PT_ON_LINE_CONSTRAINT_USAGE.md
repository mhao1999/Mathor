# 点在线上约束功能使用说明

## 功能概述

点在线上约束功能允许用户创建一个点，并确保该点始终位于指定的线段上。当用户拖拽该点时，点会自动调整位置以保持在线上。

## 使用方法

### 1. 创建点在线上约束场景

1. 点击"点在线上约束"按钮
2. 系统会自动创建：
   - 3个点：点1(50,50)、点2(150,100)、点3(100,75)
   - 1条线段：线段1(点1-点2)
   - 2个固定约束：点1和点2被固定
   - 1个点在线上约束：点3位于线段1上

### 2. 测试拖拽功能

1. 点击"测试拖拽约束"按钮
2. 系统会尝试将点3拖拽到新位置
3. 求解器会自动调整点3的位置以保持在线上

### 3. 手动拖拽测试

1. 在绘图区域中直接拖拽点3
2. 观察点3如何自动调整以保持在线上

## 技术实现

### 约束类型

- **SLVS_C_WHERE_DRAGGED**: 固定点1和点2的位置
- **SLVS_C_PT_ON_LINE**: 使点3位于线段1上

### 求解过程

1. 当用户拖拽点3时，系统调用`solveDragConstraint`方法
2. 求解器创建SolveSpace系统，包含所有点、线段和约束
3. 应用所有约束条件
4. 求解器计算新的点位置
5. 更新界面显示

### 关键代码位置

- `EaSession::createPtInLineConstraint()`: 创建点在线上约束场景
- `EaSession::addPtOnLineConstraint()`: 添加点在线上约束
- `GeometrySolver::solveDragConstraint()`: 求解拖拽约束

## 预期效果

当拖拽点3时：
- 点1和点2保持固定位置
- 点3自动调整位置以保持在线上
- 线段1保持稳定
- 所有约束条件得到满足

## 系统自由度分析

- 总自由度：6（3个点的X、Y坐标）
- 固定约束：4个（点1和点2的X、Y参数）
- 点在线上约束：1个
- 剩余自由度：6 - 4 - 1 = 1

这意味着点3可以沿线段移动，但必须保持在线上。

## 调试信息

系统会在控制台输出详细的调试信息，包括：
- 创建的点、线段和约束
- 求解过程中的参数和实体
- 求解结果和自由度信息

## 注意事项

1. 确保在创建约束前先点击"点在线上约束"按钮
2. 如果求解失败，检查控制台输出的错误信息
3. 点在线上约束需要至少一个点和一条线段才能生效
4. 线段的两端点应该被固定以确保约束系统稳定

## 扩展功能

这个功能可以扩展为：
- 多个点在同一条线上
- 点在多条线的交点上
- 点在线段的特定位置（如中点）
- 点在线段上的相对位置约束
